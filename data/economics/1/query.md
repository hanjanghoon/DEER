Write an academic paper analyzing how a producer determines the optimal price when facing a discontinuous or capacity-constrained supply, and how such a constraint generates excess demand at equilibrium.

Use the following case as the analytical foundation: A producer can sell up to 10 units of a good at zero marginal cost; beyond that point, the marginal cost becomes infinite. There are 100 customers, each with an individual demand function that depends on price $P$ and total market demand $Q$:
$$q_i=400-100P+\frac{Q}{100}+3Q^2-\frac{Q^3}{20}$$.

The seller chooses a price to maximize profit. The paper should develop a formal theoretical framework that captures this situation and generalize its implications for equilibrium formation in capacity-limited markets. The analysis should include:
- Model Development: A formal derivation of the total market demand and the inverse demand curve, showing how the aggregate demand depends on price and on strategic interdependence (the feedback of total $Q$ into each $q_i$​).
- Profit Maximization: Construction of the producer’s profit function and derivation of the equilibrium price and quantity under the constraint that only 10 units can be produced.
- Excess Demand and Rationing: Analysis of the equilibrium when demand exceeds capacity—how excess demand arises, and how rationing or non-price allocation mechanisms might operate.
- Comparative Statics: Examination of how equilibrium outcomes and excess demand change with variations in the number of consumers, cost thresholds, or the functional dependence on total demand.
- Economic Interpretation: Discussion of how such discontinuous cost structures relate to real-world capacity-constrained markets (e.g., electricity, bandwidth, event tickets), and what efficiency or welfare implications follow.
